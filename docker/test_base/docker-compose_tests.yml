x-common: &_common
  network_mode: bridge
  environment:
    OUTPUT_DIR: /test_result
    CERTS_DIR: /certs
  volumes:
    - ../..:/otaclient_src:ro
    - ../../test_result:/test_result:rw

x-build_common: &_build_common
  context: ../../
  dockerfile: ./docker/test_base/Dockerfile

services:
  tester-ubuntu-18.04:
    build:
      <<: *_build_common
      args:
        - UBUNTU_BASE=ubuntu:18.04
    image: ota-test_base:ubuntu1804
    container_name: ota-test_ubuntu1804
    <<: *_common

  tester-ubuntu-20.04:
    build:
      <<: *_build_common
      args:
        - UBUNTU_BASE=ubuntu:20.04
    image: ota-test_base:ubuntu2004
    container_name: ota-test_ubuntu2004
    <<: *_common

  tester-ubuntu-22.04:
    build:
      <<: *_build_common
      args:
        - UBUNTU_BASE=ubuntu:22.04
    image: ota-test_base:ubuntu2204
    container_name: ota-test_ubuntu2204
    <<: *_common
